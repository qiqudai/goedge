# 安装说明（功能理解）

## 核心角色与组件
- 系统由两部分组成：主控与节点 Agent。
- 主控包含主控程序、MySQL、Elasticsearch。
- 安装前需要在官网购买授权并设置主控 IP。

## 资源与环境要求
- 主控：内存建议 16G+（小规模可 8G，至少 4G）；硬盘建议 SSD 100G+；CPU 至少 2 核；开放 80、9200 及主控通讯端口。
- 节点：内存 2G+（1G 机器需加 swap）；硬盘按缓存需求；CPU 越强越好；开放 80/443。
- 支持系统：Ubuntu 24.04/22.04/16.04，Debian 11/12，CentOS 7。

## 主控安装方式
1) 干净系统一键安装（脚本）：指定 ES 数据目录。
2) 宝塔环境安装：安装宝塔与 LNMP，设置 MySQL，创建网站目录，开放端口，执行脚本并配置反向代理。

## 配置关键点
- Nginx 增加 `location /` 与 `location @cdnfly` 反代到 `127.0.0.1:88`（端口替换为安装后显示的主控通讯端口）。
- 主控登录地址：`http://主控IP/` 或 `http://主控域名/`。
- 默认账号：管理员 `admin/cdnfly`，普通用户 `jason/cdnfly`。

## 节点安装与卸载
- 节点安装命令在主控“系统管理 -> 系统升级”中获取并执行。
- 主控/节点可通过脚本卸载。

## 特殊安装模式
- 仅安装 Elasticsearch。
- 安装主控但不安装 ES，连接外部 ES（需配置 ES IP 与密码）。

# 安装说明（实现思路）

## 产品化拆解
1) 授权与主控初始化
   - 购买/绑定授权流程。
   - 主控 IP 校验与授权绑定提示。
2) 主控安装向导
   - 环境检测（OS、内存、磁盘、端口）。
   - 一键安装与自定义安装分支。
3) ES 与数据库策略
   - 内置部署与外部 ES 选项。
   - ES 数据目录与容量规划提示。
4) 反向代理配置
   - 生成标准 Nginx 片段，提示通讯端口替换。
5) 账号与安全
   - 首次登录强制修改默认密码与安全提示。
6) 节点安装与升级
   - 从主控生成节点安装命令，支持复制与执行检查。
7) 卸载与回滚
   - 显示卸载指引与风险提示。

## 建议的功能模块
- 安装向导页面（含环境检测与脚本生成）。
- 端口与服务健康检查（80/443/9200/通讯端口）。
- 节点安装管理（命令生成、在线状态、版本升级）。
- 特殊安装选项（仅 ES / 外部 ES）。

## 关键交互与提示
- 安装前检查与失败原因提示（端口占用、内存不足、磁盘不足）。
- 安装完成后展示通讯端口与登录地址。
- 明示默认账号，要求首次修改密码。
